# 5 Ducks Search System Flow Diagrams

## Main Search Flow

```
┌──────────┐       ┌───────────────┐       ┌──────────────────┐
│          │       │               │       │                  │
│  Client  ├──────►│ API Endpoint  ├──────►│ Company Overview │
│          │       │               │       │     Module       │
└──────────┘       └───────────────┘       └──────────┬───────┘
                                                      │
                                                      │
                                                      ▼
                    ┌────────────────┐       ┌──────────────────┐       ┌─────────────┐
                    │                │       │                  │       │             │
                    │    Database    │◄──────┤  Decision Maker  │◄──────┤  Perplexity │
                    │                │       │     Module       │       │     API     │
                    └────────┬───────┘       └──────────┬───────┘       └─────────────┘
                             │                          │
                             │                          │
                             │                          ▼
                             │                ┌──────────────────┐
                             │                │                  │
                             └───────────────►│  Email Discovery │
                                              │     Module       │
                                              └──────────┬───────┘
                                                         │
                                                         │
                                                         ▼
┌──────────┐                 ┌───────────────┐       ┌──────────────────┐
│          │                 │               │       │                  │
│  Client  │◄────────────────┤ API Response  │◄──────┤    Post-Search   │
│          │                 │               │       │    Enrichment    │
└──────────┘                 └───────────────┘       └──────────────────┘
```

## Email Discovery Module Flow

```
┌──────────────────┐
│                  │
│  Email Discovery │
│     Module       │
└────────┬─────────┘
         │
         │
    ┌────▼─────┐        ┌───────────────────────────┐
    │          │─────┬──►  Website Crawler Strategy  │
    │          │     │  └───────────────────────────┘
    │          │     │  ┌───────────────────────────┐
    │ Strategy │     ├──►  Pattern Prediction        │
    │ Selection│     │  └───────────────────────────┘
    │          │     │  ┌───────────────────────────┐
    │          │     ├──►  Public Directory Search   │
    │          │     │  └───────────────────────────┘
    └────┬─────┘     │  ┌───────────────────────────┐
         │           └──►  Social Profile Search     │
         │              └───────────────────────────┘
         │
    ┌────▼─────┐
    │          │
    │ Results  │
    │ Merging  │
    │          │
    └────┬─────┘
         │
         │
    ┌────▼─────┐
    │          │
    │ Email    │
    │Validation│
    │          │
    └────┬─────┘
         │
         │
    ┌────▼─────┐
    │          │
    │ Return   │
    │ Contacts │
    │          │
    └──────────┘
```

## Contact Validation Flow

```
┌──────────────────┐
│                  │
│  Raw Contact     │
│     Data         │
└────────┬─────────┘
         │
         │
         ▼
┌──────────────────┐    ┌───────────────────────────┐
│                  │    │                           │
│  Name Extraction │───►│  Placeholder Name Filter  │
│                  │    │                           │
└────────┬─────────┘    └───────────┬───────────────┘
         │                          │
         │                          │
         ▼                          ▼
┌──────────────────┐    ┌───────────────────────────┐
│                  │    │                           │
│  Context Analysis│───►│  Company Name Check       │
│                  │    │                           │
└────────┬─────────┘    └───────────┬───────────────┘
         │                          │
         │                          │
         ▼                          ▼
┌──────────────────┐    ┌───────────────────────────┐
│                  │    │                           │
│  Role Extraction │───►│   Role Validation         │
│                  │    │                           │
└────────┬─────────┘    └───────────┬───────────────┘
         │                          │
         │                          │
         ▼                          ▼
┌──────────────────┐    ┌───────────────────────────┐
│                  │    │                           │
│  AI Validation   │───►│ Combined Score Calculation│
│  (if enabled)    │    │                           │
└────────┬─────────┘    └───────────┬───────────────┘
         │                          │
         │                          │
         ▼                          ▼
┌──────────────────┐
│                  │
│  Validated       │
│  Contact Data    │
└──────────────────┘
```

## Email Discovery Strategy Selection

```
┌───────────────────────────────────────────────────────┐
│                                                       │
│  Email Discovery Module Configuration                 │
│                                                       │
│  ┌───────────────┐  ┌───────────────┐                 │
│  │ Website       │  │ Pattern       │                 │
│  │ Crawler       │  │ Prediction    │                 │
│  │ defaultEnabled│  │ defaultEnabled│                 │
│  │ = true        │  │ = true        │                 │
│  └───────┬───────┘  └───────┬───────┘                 │
│          │                  │                         │
│  ┌───────▼───────┐  ┌───────▼───────┐                 │
│  │ Public        │  │ Enhanced      │                 │
│  │ Directory     │  │ Pattern       │                 │
│  │ defaultEnabled│  │ defaultEnabled│                 │
│  │ = true        │  │ = false       │                 │
│  └───────┬───────┘  └───────┬───────┘                 │
│          │                  │                         │
│  ┌───────▼───────┐  ┌───────▼───────┐                 │
│  │ Social        │  │ Domain        │                 │
│  │ Profile       │  │ Analysis      │                 │
│  │ defaultEnabled│  │ defaultEnabled│                 │
│  │ = false       │  │ = true        │                 │
│  └───────────────┘  └───────────────┘                 │
│                                                       │
└───────────────────────────────────────────────────────┘
           │                  │
           │                  │
           ▼                  ▼
┌─────────────────────┐    ┌────────────────────┐
│                     │    │                    │
│  subsearches        │    │  config.searchOptions │
│  configuration      │    │                    │
│  from search        │    │  useEnhancedValidation │
│  approach settings  │    │                    │
└──────────┬──────────┘    └─────────┬──────────┘
           │                         │
           └─────────┬───────────────┘
                     │
                     ▼
┌───────────────────────────────────────────┐
│                                           │
│  Final Strategy Selection                 │
│  for Current Search                       │
│                                           │
└───────────────────────────────────────────┘
```

## Search Results Data Flow

```
┌───────────────────┐     ┌───────────────────┐     ┌───────────────────┐
│                   │     │                   │     │                   │
│ Company Overview  │────►│  Decision Maker   │────►│  Email Discovery  │
│ Module Results    │     │  Module Results   │     │  Module Results   │
│                   │     │                   │     │                   │
└───────────────────┘     └───────────────────┘     └───────────────────┘
         │                         │                          │
         │                         │                          │
         │                         │                          │
         ▼                         ▼                          ▼
┌───────────────────────────────────────────────────────────────────────┐
│                                                                       │
│                           Merged Results                              │
│                                                                       │
│  ┌─────────────────┐   ┌─────────────────┐   ┌─────────────────────┐ │
│  │                 │   │                 │   │                     │ │
│  │    Companies    │   │    Contacts     │   │    Metadata         │ │
│  │                 │   │                 │   │                     │ │
│  │ - name          │   │ - name          │   │ - completedSearches │ │
│  │ - website       │   │ - role          │   │ - validationScores  │ │
│  │ - industry      │   │ - email         │   │ - moduleTypes       │ │
│  │ - size          │   │ - probability   │   │                     │ │
│  │ - location      │   │ - source        │   │                     │ │
│  │                 │   │                 │   │                     │ │
│  └─────────────────┘   └─────────────────┘   └─────────────────────┘ │
│                                                                       │
└───────────────────────────────────────────────────────────────────────┘
                                    │
                                    │
                                    ▼
                        ┌─────────────────────────┐
                        │                         │
                        │      Database           │
                        │      Storage            │
                        │                         │
                        └─────────────────────────┘
```